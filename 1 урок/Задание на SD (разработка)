Нужен system design для системы для сбора аналитических данных с разных площадок (маркетплейсов, социальных сетей) и генерации дашбоардов по этим данным.


Есть группа аналитиков, которым нужен инструмент для генерации аналитических отчетов для создания рекомендаций
- по продажам для поставщиков маркетплейсов,
- по продвижению групп для владельцев групп в социальных сетях.  

Данные маркетплейсов: товары на wb, товары на ozon, и прочих - статистика продаж поставщиков.
Данные соцсетей: посты пользователей и групп vk, facebook - посты (текст, медиа), лайки, комментарии.

Каждый день выполняется сбор информации, цель - сформировать "дашбоарды" со статистикой по собранным данным.
Данные собираются с использованием различных фильтров и агрегаций по выбранным критериям. 

Например, для маркетплейсов, критерии могут быть такими:
- характеристики товара: название, категория, наличие, цена, параметры.
- характеристики заказа: общая сумма, общее количество позиций, состав (цена и количество по позициям), информация о возврате, замене, отмене заказа.
- информация по доставке (тип, адрес, дата, время, длительность).

- Функциональные:
    - Авторизация/регистрации в системе уже есть.

    - Возможность указывать источник для аналитики (через API клиента платформы, с авторизацией по токену).

    - Периодический сбор аналитики по товарам и заказам поставщика 
      Например, автоматически 1 раз в день, а также должна быть возможность делать ручной сбор статистики и по расписанию.

    - Статистика по пользователю - через API клиента платформы.
      Данные - спискок товаров и статистика продаж.

    - Поиск, фильтрация, агрегация собранной информации.

    - Прогнозирование на основе статистических данных, используя ИИ (нужно придумать как правильно обучать модель)


1. Аудитория приложения

    1.1. Количество пользователей
     Ответ: 10 000 поставщиков.
            30 аналитиков

    1.2. Поведение пользователей:    
       write: 100 запросов в DAU - по всем аналитикам (генерация различных отчетов)
       read:  от 10000 до 20000 запросов в DAU - загрузка данных по поставщикам через платформенные API (статистическая информация о продажах, доставках, товарах, категориях, ценах, наличии)

    1.3. Регионы использования
        Ответ: Только в РФ.

    2.1. Сезонные изменения нагрузки
        Вопрос: Есть ли периоды, когда количество генерации аналитики резко увеличивается?
        Ответ: Да, черная пятница, предновогодние распродажи, квартальные отчеты.


    2.2. Хранение данных
        Вопрос: Данные хранятся постоянно или можно удалять/агрегировать их со временем?
        Ответ: Храним всегда.

    2.3. Лимиты и ограничения
        Аналитика на 2 ближайших года (для возможности сравнения статистики год к году)

    2.4. Временные ограничения
        Вопрос: Как быстро должны генерироваться аналитичекские отчеты?
        Ответ: Не более 15 минут на генерацию отчета.

    2.5. Доступность приложения
        Вопрос: Сколько времени в году приложение может быть недоступно?
        Ответ: Не более нескольких дней в год (от 99 до 99.9)

3) API (основные операции)

- Занесение аналитической информации в систему.
- Выгрузка отчетов для поставщиков (для отображения дашбоардов)
- Отправка отчетов и аналитики поставщикам.

4) Модель данных
    - Поставщики
    - Информация по каталогам поставщиков
    - Таблица статистики (nosql vs clickhouse)

5) Оценка необходимого количества дисков для хранения и обработки данных.

Условно один отчет может содержать от 1 до 10 мб статистических данных.
Данные в среднем генерируются по 3-4 отчета в день для 30 аналитиков, т.е. ~100 запросов на создание отчетов.
Это ~1ГБ в день, в год ~400ГБ.

6) Верхнеуровневое проектирование основных компонентов системы и их отношений с другими компонентами системы.

- API Gateway (RESTful API) + Balancer
  Централизованная точка для взаимодействия между Frontend и Backend компонентами. Реализует бизнес-логику и обработку запросов.
    - Аутентификация пользователей.
    - Работа с аналитическими данными (генерация отчетов).
    - Управление отчетами (удаление, архивирование).
    - Интеграция с целевыми платформами (маркетплейсы, социальные сети) для выполнения сбора аналитики.

- Микросервисы
  Разделение бизнес-логики на отдельные микросервисы, которые могут включать:
    - Микросервис аналитики (внесение данных, генерация отчетов).
    - Микросервис управления пользователями.
    - Микросервис уведомлений с отчетами (email).


